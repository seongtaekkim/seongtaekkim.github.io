

기본 필요 소프트웨어
~~~

sudo apt install net-tools



~~~


도커설치
~~~

교육장에 리눅스에 아마 설치되어있을건데 없으면 설치해야 함
~~~



GNS3 설치
~~~ sh


sudo apt-get update
sudo apt-get upgrade
sudo apt-get install python3 python3-pip python3-setuptools python3-dev libpcap-dev


sudo add-apt-repository ppa:gns3/ppa
sudo apt-get update

sudo apt-get install gns3-server
sudo apt-get install gns3-gui
gns3server --version
gns3server


~~~



외부 서버에서 실행할 경우 터널링으로 테스트하자
~~~ sh
ssh -L 3080:localhost:3080 user@remote-server-ip
~~~



도커기반 설치
아래 단계는 **Ubuntu 24.04 LTS**(최신 안정 버전)를 기준으로,

1. **Docker 컨테이너로 GNS3-Server를 올리고**
    
2. 로컬(또는 다른 PC)에 설치한 **GNS3-GUI**에서 서버에 접속해 사용한 뒤
    
3. **Wireshark**로 패킷을 캡처하는 방법
    

을 순서대로 안내합니다. (모두 일반 사용자 계정에서 실행 가능)



~~~

https://junorionblog.co.kr/ubuntu-24-04-lts-server-%EC%84%A4%EC%B9%98-%EA%B0%80%EC%9D%B4%EB%93%9C/

https://ubuntu.com/download/server#manual-install

~~~

---

## 1. 선행 패키지 설치 (Docker & Wireshark)

~~~ sh

# 1-1) 시스템 업데이트
sudo apt update && sudo apt upgrade -y

# 1-2) Docker Engine + docker-compose plug-in
sudo apt install -y docker.io docker-compose-plugin

# 1-3) 현재 사용자를 docker 그룹에 추가 → 재로그인
sudo usermod -aG docker $USER
newgrp docker   # 재로그인 대신 임시로 그룹 재적용

# 1-4) Wireshark (호스트 캡처용)
sudo apt install -y wireshark
sudo usermod -aG wireshark $USER   # non-root 캡처 허용

~~~

> ❕ Wireshark 설치 중 _“non-superuser …”_ 문구가 나오면 **Yes** 선택

---

## 2. GNS3-Server 컨테이너 배포

### 2-1) 작업 디렉터리 생성

~~~ sh
mkdir -p ~/gns3-server && cd ~/gns3-server


~~~

### 2-2) `docker-compose.yml` 작성


~~~ yaml

# ~/gns3-server/docker-compose.yml


# docker‑compose.yml
version: "3.9"

services:
  gns3-server:
    image: jsimonetti/gns3-server:latest   # 커뮤니티 최신 이미지
    container_name: gns3-server
    privileged: true                       # TAP, KVM, ubridge 등 필요
    hostname: gns3
    environment:
      - TZ=Asia/Seoul
    # host 네트워크를 쓰면 포트 매핑이 필요 없고 성능이 좋음
    # network_mode: host
    ports:                                 # host 모드가 싫으면 아래 포트를 개별 매핑
      - "3080:3080"                        # REST API + Web UI
      - "5900-5999:5900-5999"              # QEMU VNC/Serial
      - "32769-32899:32769-32899/udp"      # Dynamips capture
      - "2000-2003:2000-2003/udp"          # Dynamips console
    volumes:
      - gns3_data:/data                    # 이 이미지의 기본 프로젝트 경로
      - /lib/modules:/lib/modules:ro       # 커널 모듈 read‑only 마운트
    restart: unless-stopped

volumes:
  gns3_data:


~~~

~~~ sh
docker compose up -
~~~

### 2-3) 서버 동작 확인

~~~ sh

docker logs -f gns3-server | grep "Running GNS3 server"
# 또는
curl http://localhost:3080/v2/version

~~~

---

## 3. GNS3-GUI(클라이언트) 설치·연결

### 3-1) GUI 설치

- **공식 AppImage**
    
    1. [https://github.com/GNS3/gns3-gui/releases](https://github.com/GNS3/gns3-gui/releases) 에서 최신 `*.AppImage` 다운로드
        
    2. `chmod +x gns3-gui-…AppImage && ./gns3-gui-…AppImage`
        
- 또는 **APT**(PPA):
    ~~~ sh
sudo add-apt-repository ppa:gns3/ppa
sudo apt update && sudo apt install -y gns3-gui

    ~~~
    
    

### 3-2) 첫 실행 시 서버 정보 입력

~~~ sh

GNS3 Preferences ▸ GNS3 server
  Host: 127.0.0.1
  Port: 3080
  Protocol: http


~~~

저장 → **“Test”** 버튼이 초록색 OK 로 뜨면 연결 성공.

---

## 4. 프로젝트에서 Docker 컨테이너 사용

1. **File ▸ New blank project**
    
2. Node 패널 ▸ **Docker Containers** 탭  
    (없으면 _Edit ▸ Preferences ▸ Docker_ → “Enable” 체크)
    
3. 원하는 이미지(예: alpine, frrouting/frr) 끌어다 배치
    

---

## 5. Wireshark로 패킷 캡처

### 5-1) GNS3 GUI 내 캡처

1. 토폴로지에서 **링크나 인터페이스** 우클릭 → _“Start capture”_
    
2. 팝업에서 **Wireshark** 선택 후 OK
    
3. Wireshark 창이 열리며 실시간 스트림 확인
    

> 내부적으로 `tcpdump` 결과를 **UDP 32769-32899 포트**에 스트리밍 →  
> GUI가 Wireshark를 호출해 받아 보여 줍니다(이미 compose 파일에 포트 열림).

### 5-2) 컨테이너 안 직접 캡처(보조 방법)


~~~ sh
docker exec -it <container_id> apk add --no-cache tcpdump
docker exec -it <container_id> tcpdump -nn -i eth0 -w /tmp/cap.pcap
# 마치면 Ctrl+C, 파일을 호스트로 복사
docker cp <container_id>:/tmp/cap.pcap ./cap.pcap
wireshark ./cap.pcap

~~~

---

## 6. 자주 발생하는 문제 & 해결

|증상|원인·대응|
|---|---|
|**GUI에서 서버 연결 실패**|① 포트 3080 이미 사용 중 → compose 포트 변경  <br>② Docker 그룹 적용 안 됨 → 로그아웃/로그인 후 재시도|
|**캡처 시작 시 에러**|① PCAP 스트림 포트 막힘 → compose 에 명시한 포트 범위 방화벽 허용  <br>② 컨테이너가 unprivileged → `privileged: true` 유지|
|**컨테이너에 tcpdump 없음**|Alpine·Debian 등 이미지마다 없을 수 있음 → `apk add tcpdump` or `apt update && apt install -y tcpdump`|

---

### 한 줄 요약

1. **Docker** + `docker compose` 로 **gns3/gns3-server** 컨테이너를 띄우고
    
2. 로컬에서 **GNS3-GUI** 로 서버(127.0.0.1:3080) 에 접속한 뒤
    
3. 링크 우클릭 _Start capture_ → **Wireshark** 팝업으로 실시간 패킷을 확인하면 됩니다.

~~~

{
    "computes": [],
    "templates": [],
    "gns3vm": {
        "vmname": null,
        "when_exit": "stop",
        "headless": false,
        "enable": false,
        "engine": "vmware",
        "allocate_vcpus_ram": true,
        "ram": 2048,
        "vcpus": 1,
        "port": 80
    },
    "iou_license": {
        "iourc_content": "",
        "license_check": true
    },
    "appliances_etag": null,
    "version": "2.2.54"
}
~                                                                                                                                                    
~                                                                                                                                                    
~             
~~~